<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>src.scrape.coindesk API documentation</title>
<meta name="description" content="CoinDesk is the media platform for the next generation of investors exploring how cryptocurrencies and digital assets are contributing to the â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>src.scrape.coindesk</code></h1>
</header>
<section id="section-intro">
<p>CoinDesk is the media platform for the next generation of investors exploring how cryptocurrencies and digital assets are contributing to the evolution of the global financial system. Its mandate is to inform, educate, and connect the global investment community through news, data, events and education.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
CoinDesk is the media platform for the next generation of investors exploring how cryptocurrencies and digital assets are contributing to the evolution of the global financial system. Its mandate is to inform, educate, and connect the global investment community through news, data, events and education.
&#34;&#34;&#34;

import json

from utils import logger, request
from elk import ingest

# Elastic search index
elasticPath = &#34;http://localhost:9200/crypto_news/ingest&#34;

def news_list_download(symbol, startPage, endPage):
    &#34;&#34;&#34; Download list of news url that will later be scraped 

    Args:
        symbol (str): symbol used in the search parameter, for example &#34;btc&#34;
        startPage (int): start page
        endPage (int): end page

    Returns:
        List of Dicts: list of urls and their meta data
    &#34;&#34;&#34;    
    urlList = []
    for page in range(startPage,endPage+1):
        baseUrl = &#34;https://www.coindesk.com/wp-json/v1/search?keyword=&#34;+symbol+&#34;&amp;page=&#34;
        url = baseUrl+str(page)
        response, logInfo = request.get(url, timeout = 120)
        if response.status_code == 200:
            logger.debug(logInfo+&#39; - SUCCESS!&#39;)
            articleList = json.loads(response.content)[&#39;results&#39;]
            for article in articleList:
                title = article[&#39;title&#39;]
                slug = article[&#39;slug&#39;]
                date = article[&#39;date&#39;]
                author = article[&#39;author&#39;]
                href = article[&#39;url&#39;]
                urlList.append({
                    &#34;href&#34;: href,
                    &#34;title&#34;: title,
                    &#34;slug&#34;: slug,
                    &#34;date&#34;: date,
                    &#34;author&#34;: author
                })
        else:
            logger.error(logInfo+&#39; - FAILED with error code &#39;+response.status_code+&#39; and message &#39;+response.text)
            logger.info(&#34;Skipping page &#34;+page+&#34; because request failed...&#34;)
    return urlList

def article_download(url, title, slug, date, author):
    &#34;&#34;&#34; Download a single news article given its url

    Args:
        url (string): url of news article
        title (string): human-readable title of news article
        slug (string): computer-readable title of news article
        date (string): publication date
        author (string[]): list of authors
    &#34;&#34;&#34;    
    response, logInfo = request.get(url, timeout = 120)
    if response.status_code == 200:
        logger.debug(logInfo+&#39; - SUCCESS!&#39;)
        article = response.text
        article = article.split(&#39;&#34;articleBody&#34;:&#39;)[1].split(&#39;&#34;&#39;)[1].split(&#39;&#34;&#39;)[0]
        payload = {
            &#34;title&#34;: title,
            &#34;slug&#34;: slug,
            &#34;content&#34;: article,
            &#34;date&#34;: date,
            &#34;author&#34;: author
        }
        # Ingest into Elastic Search
        ingest.ingest(post_url=elasticPath, payload=payload)
    else:
        logger.error(logInfo+&#39; - FAILED with error code &#39;+response.status_code+&#39; and message &#39;+response.text)
        logger.info(&#34;Skipping article: &#39;&#34;+title+&#34;&#39; because request failed...&#34;)

def all_articles_download(symbol, startPage=1, endPage=10):
    &#34;&#34;&#34; Download a list of news articles about a given symbol

    Args:
        symbol (str): symbol, for example &#34;btc&#34;
        startPage (int, optional): start page. Defaults to 1.
        endPage (int, optional): end page. Defaults to 10.
    &#34;&#34;&#34;    
    urlList = news_list_download(symbol=symbol, startPage=startPage, endPage=endPage)
    for url in urlList:
        href = url[&#39;href&#39;]
        title = url[&#39;title&#39;]
        slug = url[&#39;slug&#39;]
        date = url[&#39;date&#39;]
        author = url[&#39;author&#39;]
        article_download(href=href, title=title, slug=slug, date=date, author=author)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="src.scrape.coindesk.all_articles_download"><code class="name flex">
<span>def <span class="ident">all_articles_download</span></span>(<span>symbol, startPage=1, endPage=10)</span>
</code></dt>
<dd>
<div class="desc"><p>Download a list of news articles about a given symbol</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>symbol</code></strong> :&ensp;<code>str</code></dt>
<dd>symbol, for example "btc"</dd>
<dt><strong><code>startPage</code></strong> :&ensp;<code>int</code>, optional</dt>
<dd>start page. Defaults to 1.</dd>
<dt><strong><code>endPage</code></strong> :&ensp;<code>int</code>, optional</dt>
<dd>end page. Defaults to 10.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def all_articles_download(symbol, startPage=1, endPage=10):
    &#34;&#34;&#34; Download a list of news articles about a given symbol

    Args:
        symbol (str): symbol, for example &#34;btc&#34;
        startPage (int, optional): start page. Defaults to 1.
        endPage (int, optional): end page. Defaults to 10.
    &#34;&#34;&#34;    
    urlList = news_list_download(symbol=symbol, startPage=startPage, endPage=endPage)
    for url in urlList:
        href = url[&#39;href&#39;]
        title = url[&#39;title&#39;]
        slug = url[&#39;slug&#39;]
        date = url[&#39;date&#39;]
        author = url[&#39;author&#39;]
        article_download(href=href, title=title, slug=slug, date=date, author=author)</code></pre>
</details>
</dd>
<dt id="src.scrape.coindesk.article_download"><code class="name flex">
<span>def <span class="ident">article_download</span></span>(<span>url, title, slug, date, author)</span>
</code></dt>
<dd>
<div class="desc"><p>Download a single news article given its url</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>url</code></strong> :&ensp;<code>string</code></dt>
<dd>url of news article</dd>
<dt><strong><code>title</code></strong> :&ensp;<code>string</code></dt>
<dd>human-readable title of news article</dd>
<dt><strong><code>slug</code></strong> :&ensp;<code>string</code></dt>
<dd>computer-readable title of news article</dd>
<dt><strong><code>date</code></strong> :&ensp;<code>string</code></dt>
<dd>publication date</dd>
<dt><strong><code>author</code></strong> :&ensp;<code>string[]</code></dt>
<dd>list of authors</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def article_download(url, title, slug, date, author):
    &#34;&#34;&#34; Download a single news article given its url

    Args:
        url (string): url of news article
        title (string): human-readable title of news article
        slug (string): computer-readable title of news article
        date (string): publication date
        author (string[]): list of authors
    &#34;&#34;&#34;    
    response, logInfo = request.get(url, timeout = 120)
    if response.status_code == 200:
        logger.debug(logInfo+&#39; - SUCCESS!&#39;)
        article = response.text
        article = article.split(&#39;&#34;articleBody&#34;:&#39;)[1].split(&#39;&#34;&#39;)[1].split(&#39;&#34;&#39;)[0]
        payload = {
            &#34;title&#34;: title,
            &#34;slug&#34;: slug,
            &#34;content&#34;: article,
            &#34;date&#34;: date,
            &#34;author&#34;: author
        }
        # Ingest into Elastic Search
        ingest.ingest(post_url=elasticPath, payload=payload)
    else:
        logger.error(logInfo+&#39; - FAILED with error code &#39;+response.status_code+&#39; and message &#39;+response.text)
        logger.info(&#34;Skipping article: &#39;&#34;+title+&#34;&#39; because request failed...&#34;)</code></pre>
</details>
</dd>
<dt id="src.scrape.coindesk.news_list_download"><code class="name flex">
<span>def <span class="ident">news_list_download</span></span>(<span>symbol, startPage, endPage)</span>
</code></dt>
<dd>
<div class="desc"><p>Download list of news url that will later be scraped </p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>symbol</code></strong> :&ensp;<code>str</code></dt>
<dd>symbol used in the search parameter, for example "btc"</dd>
<dt><strong><code>startPage</code></strong> :&ensp;<code>int</code></dt>
<dd>start page</dd>
<dt><strong><code>endPage</code></strong> :&ensp;<code>int</code></dt>
<dd>end page</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>List</code> of <code>Dicts</code></dt>
<dd>list of urls and their meta data</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def news_list_download(symbol, startPage, endPage):
    &#34;&#34;&#34; Download list of news url that will later be scraped 

    Args:
        symbol (str): symbol used in the search parameter, for example &#34;btc&#34;
        startPage (int): start page
        endPage (int): end page

    Returns:
        List of Dicts: list of urls and their meta data
    &#34;&#34;&#34;    
    urlList = []
    for page in range(startPage,endPage+1):
        baseUrl = &#34;https://www.coindesk.com/wp-json/v1/search?keyword=&#34;+symbol+&#34;&amp;page=&#34;
        url = baseUrl+str(page)
        response, logInfo = request.get(url, timeout = 120)
        if response.status_code == 200:
            logger.debug(logInfo+&#39; - SUCCESS!&#39;)
            articleList = json.loads(response.content)[&#39;results&#39;]
            for article in articleList:
                title = article[&#39;title&#39;]
                slug = article[&#39;slug&#39;]
                date = article[&#39;date&#39;]
                author = article[&#39;author&#39;]
                href = article[&#39;url&#39;]
                urlList.append({
                    &#34;href&#34;: href,
                    &#34;title&#34;: title,
                    &#34;slug&#34;: slug,
                    &#34;date&#34;: date,
                    &#34;author&#34;: author
                })
        else:
            logger.error(logInfo+&#39; - FAILED with error code &#39;+response.status_code+&#39; and message &#39;+response.text)
            logger.info(&#34;Skipping page &#34;+page+&#34; because request failed...&#34;)
    return urlList</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="src.scrape" href="index.html">src.scrape</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="src.scrape.coindesk.all_articles_download" href="#src.scrape.coindesk.all_articles_download">all_articles_download</a></code></li>
<li><code><a title="src.scrape.coindesk.article_download" href="#src.scrape.coindesk.article_download">article_download</a></code></li>
<li><code><a title="src.scrape.coindesk.news_list_download" href="#src.scrape.coindesk.news_list_download">news_list_download</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>